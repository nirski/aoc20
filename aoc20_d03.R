library(tidyverse)
library(aocodeR)

# Data ---------------------------------------------------------------------------------------------

d03_d1 <- aoc_get_input(3, 2020, "AOC_COOKIE") %>%
    read_table("input")

# Functions ----------------------------------------------------------------------------------------

d03_f1 <- function(d, h, v) {
    d %>%
        mutate(
            i = (h/v * (row_number() - 1)) %% 31 + 1,
            c = ifelse(i %% 1 == 0, str_sub(input, i, i), ".")
        ) %>%
        tally(c == "#")
}

# Part 1 -------------------------------------------------------------------------------------------

d03_d1 %>% d03_f1(3, 1)

# Part 2 -------------------------------------------------------------------------------------------

tribble(~h, ~v, 1, 1, 3, 1, 5, 1, 7, 1, 1, 2) %>%
    expand_grid(d = list(d03_d1)) %>%
    mutate(p = pmap_int(list(d, h, v), compose(unlist, d03_f1))) %>%
    pull(p) %>%
    prod()
